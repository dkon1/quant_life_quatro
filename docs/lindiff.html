<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Quantifying Life - 10&nbsp; Linear difference equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./graph_odes.html" rel="next">
<link href="./sampling.html" rel="prev">
<link href="./Kondrashov_Comp.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Quantifying Life - 10&nbsp; Linear difference equations">
<meta name="twitter:description" content="All living things change over time, and this evolution can be quantitatively measured and analyzed.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear difference equations</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Quantifying Life</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dkon1/quant_life_quatro" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Quantifying-Life.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Quantifying-Life.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./counting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Arithmetic and variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Functions and their graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Describing data sets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probdist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random variables and distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linreg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independence.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Independence</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypo_test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Prior knowledge and Bayesian thinking</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sampling distribution and estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lindiff.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear difference equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graph_odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ode_sols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Solutions of ordinary differential equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markov_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Markov models with discrete states</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markov_evol.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Probability distributions of Markov chains</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markov_stat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Stationary distributions of Markov chains</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markov_eigen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Dynamics of Markov models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#discrete-time-population-models" id="toc-discrete-time-population-models" class="nav-link active" data-scroll-target="#discrete-time-population-models"><span class="toc-section-number">10.1</span>  Discrete time population models</a>
  <ul class="collapse">
  <li><a href="#static-population" id="toc-static-population" class="nav-link" data-scroll-target="#static-population"><span class="toc-section-number">10.1.1</span>  static population</a></li>
  <li><a href="#exponential-population-growth" id="toc-exponential-population-growth" class="nav-link" data-scroll-target="#exponential-population-growth"><span class="toc-section-number">10.1.2</span>  exponential population growth</a></li>
  <li><a href="#population-with-births-and-deaths" id="toc-population-with-births-and-deaths" class="nav-link" data-scroll-target="#population-with-births-and-deaths"><span class="toc-section-number">10.1.3</span>  population with births and deaths</a></li>
  <li><a href="#dimensions-of-birth-and-death-rates" id="toc-dimensions-of-birth-and-death-rates" class="nav-link" data-scroll-target="#dimensions-of-birth-and-death-rates"><span class="toc-section-number">10.1.4</span>  dimensions of birth and death rates</a></li>
  <li><a href="#linear-demographic-models" id="toc-linear-demographic-models" class="nav-link" data-scroll-target="#linear-demographic-models"><span class="toc-section-number">10.1.5</span>  linear demographic models</a></li>
  </ul></li>
  <li><a href="#solutions-of-linear-difference-models" id="toc-solutions-of-linear-difference-models" class="nav-link" data-scroll-target="#solutions-of-linear-difference-models"><span class="toc-section-number">10.2</span>  Solutions of linear difference models</a>
  <ul class="collapse">
  <li><a href="#simple-linear-models" id="toc-simple-linear-models" class="nav-link" data-scroll-target="#simple-linear-models"><span class="toc-section-number">10.2.1</span>  simple linear models</a></li>
  <li><a href="#models-with-a-constant-term" id="toc-models-with-a-constant-term" class="nav-link" data-scroll-target="#models-with-a-constant-term"><span class="toc-section-number">10.2.2</span>  models with a constant term</a></li>
  <li><a href="#population-growth-and-decline" id="toc-population-growth-and-decline" class="nav-link" data-scroll-target="#population-growth-and-decline"><span class="toc-section-number">10.2.3</span>  population growth and decline</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">10.2.4</span>  Exercises</a></li>
  </ul></li>
  <li><a href="#numerical-solutions-in-r" id="toc-numerical-solutions-in-r" class="nav-link" data-scroll-target="#numerical-solutions-in-r"><span class="toc-section-number">10.3</span>  Numerical solutions in R</a>
  <ul class="collapse">
  <li><a href="#for-loops" id="toc-for-loops" class="nav-link" data-scroll-target="#for-loops"><span class="toc-section-number">10.3.1</span>  for loops</a></li>
  <li><a href="#using-vectors-with-loops" id="toc-using-vectors-with-loops" class="nav-link" data-scroll-target="#using-vectors-with-loops"><span class="toc-section-number">10.3.2</span>  using vectors with loops</a></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1"><span class="toc-section-number">10.3.3</span>  Exercises:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear difference equations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>We’re captive on the carousel of time<br>
We can’t return we can only look behind<br>
From where we came<br>
And go round and round and round<br>
In the circle game<br>
– Joni Mitchell, <em>The Circle Game</em></p>
</blockquote>
<p>All living things change over time, and this evolution can be quantitatively measured and analyzed. Mathematics makes use of equations to define models that change with time, known as <em>dynamical systems</em>. In this unit we will learn how to construct models that describe the time-dependent behavior of some measurable quantity in life sciences. Numerous fields of biology use such models, and in particular we will consider changes in population size, the progress of biochemical reactions, the spread of infectious disease, and the spikes of membrane potentials in neurons, as some of the main examples of biological dynamical systems.</p>
<p>Many processes in living things happen regularly, repeating with a fairly constant time period. One common example is the reproductive cycle in species that reproduce periodically, whether once a year, or once an hour, like certain bacteria that divide at a relatively constant rate under favorable conditions. Other periodic phenomena include circadian (daily) cycles in physiology, contractions of the heart muscle, and waves of neural activity. For these processes, theoretical biologists use models with <em>discrete time</em>, in which the time variable is restricted to the integers. For instance, it is natural to count the generations in whole numbers when modeling population growth.</p>
<p>This chapter will be devoted to analyzing dynamical systems in which time is measured in discrete steps. In this chapter you will learn to do the following:</p>
<ul>
<li><p>write down discrete-time (difference) equations based on stated assumptions</p></li>
<li><p>find analytic solutions of linear difference equations</p></li>
<li><p>use for loops in R</p></li>
<li><p>compute numeric solutions of difference equations</p></li>
</ul>
<section id="discrete-time-population-models" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="discrete-time-population-models"><span class="header-section-number">10.1</span> Discrete time population models</h2>
<p></p>
<p>Let us construct our first models of biological systems. We will start by considering a population of some species, with the goal of tracking its growth or decay over time. The variable of interest is the number of individuals in the population, which we will call <span class="math inline">\(N\)</span>. This is called the dependent variable, since its value changes depending on time; it would make no sense to say that time changes depending on the population size. Throughout the study of dynamical systems, we will denote the independent variable of time by <span class="math inline">\(t\)</span>. To denote the population size at time <span class="math inline">\(t\)</span>, we can write <span class="math inline">\(N(t)\)</span> but sometimes use <span class="math inline">\(N_t\)</span>.</p>
<section id="static-population" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="static-population"><span class="header-section-number">10.1.1</span> static population</h3>
<p>In order to describe the dynamics, we need to write down a rule for how the population changes. Consider the simplest case, in which the population stays the same for all time. (Maybe it is a pile of rocks?) Then the following equation describes this situation: <span class="math display">\[N(t+1) = N(t) \]</span> This equation mandates that the population at the next time step be the same as at the present time <span class="math inline">\(t\)</span>. This type of equation is generally called a <em>difference equation</em>, because it can be written as a difference between the values at the two different times: <span class="math display">\[N(t+1) - N(t) = 0\]</span> This version of the model illustrates that a difference equation at its core describes the increments of <span class="math inline">\(N\)</span> from one time step to the next. In this case, the increments are always 0, which makes it plain that the population does not change from one time step to the next.</p>
</section>
<section id="exponential-population-growth" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="exponential-population-growth"><span class="header-section-number">10.1.2</span> exponential population growth</h3>
<p>Let us consider a more interesting situation: as a colony of dividing bacteria, such as <em>E. coli</em>, shown in figure <span class="math inline">\(\ref{fig:ch14_cell_div}\)</span>. We will assume that each bacterial cell divides and produces two daughter cells at fixed intervals of time, and let us further suppose that bacteria never die. Essentially, we are assuming a population of immortal bacteria with clocks. This means that after each cell division the population size doubles. As before, we denote the number of cells in each generation by <span class="math inline">\(N(t)\)</span>, and obtain the equation describing each successive generation: <span class="math display">\[ N(t+1) = 2N(t)\]</span> It can also be written in the difference form, as above: <span class="math display">\[ N(t+1) - N(t) = N(t) \]</span> The increment in population size is determined by the current population size, so the population in this model is forever growing. This type of behavior is termed <em>exponential growth</em>, which we will investigate further in section <span class="math inline">\(\ref{sec:math14}\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ch14/Ecoli_dividing.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Scanning electron micrograph of a dividing <em>Escherichia coli</em> bacteria; image by Evangeline Sowers, Janice Haney Carr (CDC) in public domain via Wikimedia Commons.</figcaption><p></p>
</figure>
</div>
</section>
<section id="population-with-births-and-deaths" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="population-with-births-and-deaths"><span class="header-section-number">10.1.3</span> population with births and deaths</h3>
<p>Suppose that a type of fish lives to reproduce only once after a period of maturation, after which the adults die. In this simple scenario, half of the population is female, a female always lays 1000 eggs, and of those, 1% survive to maturity and reproduce. Let us set up the model for the population growth of this idealized fish population. The general idea, as before, is to relate the population size at the next time step <span class="math inline">\(N(t+1)\)</span> to the population at the present time <span class="math inline">\(N(t)\)</span>.</p>
<p>Let us tabulate both the increases and the decreases in the population size. We have <span class="math inline">\(N(t)\)</span> fish at the present time, but we know they all die after reproducing, so there is a decrease of <span class="math inline">\(N(t)\)</span> in the population. Since half of the population is female, the number of new offspring produced by <span class="math inline">\(N(t)\)</span> fish is <span class="math inline">\(500N(t)\)</span>. Of those, only 1% survive to maturity (the next time step), and the other 99% (<span class="math inline">\(495N(t)\)</span>) die. We can add all the terms together to obtain the following difference equation: <span class="math display">\[
N(t+1) = N(t) - N(t) + 500N(t) - 495 N(t)  = 5N(t)
\]</span></p>
<p>The number 500 in the expression is the <em>birth rate</em> of the population per individual, and the negative terms add up to the <em>death rate</em> of 496 per individual. We can re-write the equation in difference form: <span class="math display">\[
N(t+1) - N(t) = 4N(t)
\]</span></p>
<p>This expression again generates growth in the population, because the birth rate outweighs the death rate. </p>
</section>
<section id="dimensions-of-birth-and-death-rates" class="level3" data-number="10.1.4">
<h3 data-number="10.1.4" class="anchored" data-anchor-id="dimensions-of-birth-and-death-rates"><span class="header-section-number">10.1.4</span> dimensions of birth and death rates</h3>
<p>As we discussed in section <span class="math inline">\(\ref{sec:model2}\)</span> the dimensions of quantities in a model have to satisfy the rules of dimensional analysis we discussed in chapter 2. In the case of population models, the birth and death rates measure the number of individuals that are born (or die) within a reproductive cycle for every individual at the present time. Their dimensions must be such that the terms in the equation all match: <span class="math display">\[ [N(t+1) - N(t)] = [population] = [r] [N(t)] = [r]  \times [population] \]</span> This implies that <span class="math inline">\(r\)</span> is algebraically dimensionless. However, the meaning of <span class="math inline">\(r\)</span> is the rate of change of population over one (generation) time step. <span class="math inline">\(r\)</span> is the birth or death rate of the population <em>per generation</em>, and therefore, when such rates are measured, they are reported with units of inverse time (e.g.&nbsp;number of offspring per year).</p>
</section>
<section id="linear-demographic-models" class="level3" data-number="10.1.5">
<h3 data-number="10.1.5" class="anchored" data-anchor-id="linear-demographic-models"><span class="header-section-number">10.1.5</span> linear demographic models</h3>
<p>We will now write a general difference equation for any population with constant birth and death rates. This will allow us to substitute arbitrary values of the birth and death rates to model different biological situations. Suppose that a population has the birth rate of <span class="math inline">\(b\)</span> per individual, and the death rate <span class="math inline">\(d\)</span> per individual. Then the general model of the population size is: <span class="math display">\[\begin{equation}
N(t+1) = (1 + b - d)N(t)
\label{linear_pop}
\end{equation}\]</span></p>
<p>The general equation also allows us to check the dimensions of birth and death rates, especially as written in the incremental form: $ N(t+1) - N(t) = (b - d)N(t)$. The change in population rate over one reproductive cycle is given by the current population size multiplied by the difference of birth and death rates, which as we saw are algebraically dimensionless. The right hand side of the equation has the dimensions of population size, matching the difference on the left hand side. </p>
</section>
</section>
<section id="solutions-of-linear-difference-models" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="solutions-of-linear-difference-models"><span class="header-section-number">10.2</span> Solutions of linear difference models</h2>
<p></p>
<section id="simple-linear-models" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="simple-linear-models"><span class="header-section-number">10.2.1</span> simple linear models</h3>
<p>Having set up the difference equation models, we would naturally like to solve them to find out how the dependent variable, such as population size, varies over time. A solution may be <em>analytic</em>, meaning that it can be written as a formula, or <em>numerical</em>, in which case it is generated by a computer in the form of a sequence of values of the dependent variable over a period of time. In this section, we will find some simple analytic solutions and learn to analyze the behavior of difference equations which we cannot solve exactly.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>A function <span class="math inline">\(N(t)\)</span> is a (over some time period <span class="math inline">\(a &lt; t &lt; b\)</span>) of a difference equation <span class="math inline">\(N(t+1) = f(N(t))\)</span> if it satisfies that equation (over some time period <span class="math inline">\(a &lt; t &lt; b\)</span>).</p>
</div>
</div>
<p></p>
<p>For instance, let us take our first model of the static population, <span class="math inline">\(N(t+1) = N(t)\)</span>. Any constant function is a solution, for example, <span class="math inline">\(N(t) = 0\)</span>, or <span class="math inline">\(N(t) = 10\)</span>. There are actually as many solutions as there are numbers, that is, infinitely many! In order to specify exactly what happens in the model, we need to specify the size of the population at some point, usually, at the “beginning of time”, <span class="math inline">\(t = 0\)</span>. This is called the <em>initial condition</em> for the model, and for a well-behaved difference equation it is enough to determine a unique solution. For the static model, specifying the initial condition is the same as specifying the population size for all time.</p>
<p>Now let us look at the general model of population growth with constant birth and death rates. We saw in equation <span class="math inline">\(\ref{linear_pop}\)</span> above that these can be written in the form <span class="math inline">\(N(t+1) = (1 + b - d) N(t)\)</span>. To simplify, let us combine the numbers into one growth parameter <span class="math inline">\(r = 1 + b - d\)</span>, and write down the general equation for population growth with constant growth rate: <span class="math display">\[N(t+1) =  rN(t)\]</span></p>
<p>To find the solution, consider a specific example, where we start with the initial population size <span class="math inline">\(N_0 = 1\)</span>, and the growth rate <span class="math inline">\(r=2\)</span>. The sequence of population sizes is: 1, 2, 4, 8, 16, etc. This is described by the formula <span class="math inline">\(N(t) = 2^t\)</span>.</p>
<p>In the general case, each time step the solution is multiplied by <span class="math inline">\(r\)</span>, so the solution has the same exponential form. The initial condition <span class="math inline">\(N_0\)</span> is a multiplicative constant in the solution, and one can verify that when <span class="math inline">\(t=0\)</span>, the solution matches the initial value: <span class="math display">\[\begin{equation}
N(t)  = r^t N_0
\label{eq:lin_discrete_sol}
\end{equation}\]</span></p>
<p>I would like the reader to pause and consider this remarkable formula. No matter what the birth and death parameters are selected, this solution predicts the population size at any point in time <span class="math inline">\(t\)</span>.</p>
<p>In order to verify that the formula for <span class="math inline">\(N(t)\)</span> is actually a solution in the meaning of definition <span class="math inline">\(\ref{def:math14_sol}\)</span>, we need to check that it actually satisfies the difference equation for all <span class="math inline">\(t\)</span>, not just a few time steps. This can be done algebraically by plugging in <span class="math inline">\(N(t+1)\)</span> into the left side of the dynamic model and <span class="math inline">\(N(t)\)</span> into the right side and checking whether they match. For <span class="math inline">\(N(t)\)</span> given by equation <span class="math inline">\(\ref{eq:lin_discrete_sol}\)</span>, <span class="math inline">\(N(t+1) = r^{t+1} N_0\)</span>, and thus the dynamic model becomes: <span class="math display">\[r^{t+1} N_0 = r \times r^t N_0\]</span> Since the two sides match, this means the solution is correct.</p>
</section>
<section id="models-with-a-constant-term" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="models-with-a-constant-term"><span class="header-section-number">10.2.2</span> models with a constant term</h3>
<p>Now let us consider a dynamic model that combines two different rates: a proportional rate (<span class="math inline">\(rN\)</span>) and a constant rate which does not depend on the value of the variable <span class="math inline">\(N\)</span>. We can write such a generic model as follows: <span class="math display">\[ N(t+1) =  rN(t) + a \]</span> The right-hand-side of this equation is a linear function of <span class="math inline">\(N\)</span>, so this is a linear difference equation with a constant term. What function <span class="math inline">\(N(t)\)</span> satisfies it? One can quickly check that that the same solution <span class="math inline">\(N(t) = r^t N_0\)</span> does not work because of the pesky constant term <span class="math inline">\(a\)</span>: <span class="math display">\[ r^{t+1} N_0 \neq r \times r^t N_0 + a\]</span></p>
<p>To solve it, we need to try a different form: specifically, an exponential with an added constant. The exponential can be reasonably surmised to have base <span class="math inline">\(r\)</span> as before, and then leave the two constants as unknown: <span class="math inline">\(N(t) = c_1 r^t + c_2\)</span>. To figure out whether this is a solution, plug it into the linear difference equation above and check whether a choice of constants can make the two sides agree: <span class="math display">\[  N(t+1) =  c_1 r^{t +1} + c_2 = rN(t) + a  = rc_1 r^t + rc_2+ a\]</span> This equation has the same term <span class="math inline">\(c_1 r^{t +1}\)</span> on both sides, so they can be subtracted out. The remaining equation involves only <span class="math inline">\(c_2\)</span>, and its solution is <span class="math inline">\(c_2 = a/(1-r)\)</span>. Therefore, the general solution of this linear difference equation is the following expression, which is determined from the initial value by plugging <span class="math inline">\(t=0\)</span> and solving for <span class="math inline">\(c\)</span>. <span class="math display">\[\begin{equation}
N(t) = c r^t  + \frac{a}{1-r}
\label{eq:ch14_sol_wconst}
\end{equation}\]</span></p>
<p><strong>Example.</strong> Take the difference equation <span class="math inline">\(N(t+1) = 0.5 N(t) + 40\)</span> with initial value <span class="math inline">\(N(0)= 100\)</span>. The solution, according to our formula is <span class="math inline">\(N(t) = c 0.5^t + 80\)</span>. At <span class="math inline">\(N(0) = 100 = c+80\)</span>, so <span class="math inline">\(c=20\)</span>. Then the compete solution is <span class="math inline">\(N(t) = 20 \times 0.5^t + 80\)</span>. To check that this actually works, plug this solution back into the difference equation: <span class="math display">\[ N(t+1) = 20 \times 0.5^{t+1} + 80 = 0.5 \times (20 \times 0.5^t + 80) + 40 =  20 \times 0.5^{t+1} + 80\]</span> The equation is satisfied and therefore the solution is correct.</p>
</section>
<section id="population-growth-and-decline" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="population-growth-and-decline"><span class="header-section-number">10.2.3</span> population growth and decline</h3>
<p></p>
<p>The parameter <span class="math inline">\(r\)</span> can assume different values, depending on the birth and death rates. If the birth rate is greater than the death rate, <span class="math inline">\(r &gt; 1\)</span>, and if it is the other way around, <span class="math inline">\(r &lt; 1\)</span>. Note that for a realistic biological population, the death rate is limited by the number of individuals present in the population. The maximum number of individuals at any time is <span class="math inline">\(N(t)+bN(t)\)</span>, so this means that <span class="math inline">\(d \leq b +1\)</span>. Therefore, for a biological population, <span class="math inline">\(r \geq 0\)</span>.</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.7">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y0 <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>x, <span class="at">t =</span> <span class="st">"b"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"population"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y0 <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>x, <span class="at">t =</span> <span class="st">"b"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>leg.txt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"N(0)=5"</span>, <span class="st">"N(0)=1"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, leg.txt, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y0 <span class="sc">*</span> <span class="fl">0.5</span><span class="sc">^</span>x, <span class="at">t =</span> <span class="st">"b"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"population"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y0 <span class="sc">*</span> <span class="fl">0.5</span><span class="sc">^</span>x, <span class="at">t =</span> <span class="st">"b"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>leg.txt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"N(0)=1000"</span>, <span class="st">"N(0)=500"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, leg.txt, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lindiff_files/figure-html/ch14-sol-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Plots of solutions of linear difference equations: a) <span class="math inline">\(N(t+1) = 2N(t)\)</span> with different initial values; b) <span class="math inline">\(N(t+1) = 0.5N(t)\)</span> with different initial values</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lindiff_files/figure-html/ch14-sol-2.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Plots of solutions of linear difference equations: a) <span class="math inline">\(N(t+1) = 2N(t)\)</span> with different initial values; b) <span class="math inline">\(N(t+1) = 0.5N(t)\)</span> with different initial values</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The solutions in formula <span class="math inline">\(\ref{eq:lin_discrete_sol}\)</span> and <span class="math inline">\(\ref{eq:ch14_sol_wconst}\)</span> are exponential functions, which as we saw in section <span class="math inline">\(\ref{sec:math2}\)</span> have a limited menu of behaviors, depending on the value of <span class="math inline">\(r\)</span>. If <span class="math inline">\(r &gt; 1\)</span>, multiplication by <span class="math inline">\(r\)</span> increases the size of the population, so the solution <span class="math inline">\(N(t)\)</span> will grow. If <span class="math inline">\(r &lt; 1\)</span>, multiplication by <span class="math inline">\(r\)</span> decreases the size of the population, so the solution <span class="math inline">\(N(t)\)</span> will decay (see figure <span class="math inline">\(\ref{fig:ch14_solutions}\)</span>). Finally, if <span class="math inline">\(r=1\)</span>, multiplication by <span class="math inline">\(r\)</span> leaves the population size unchanged, like in the pile of rocks model. Here is the complete classification of the behavior of population models with constant birth and death rates (assuming <span class="math inline">\(r&gt;0\)</span>):</p>
<ul>
<li><span class="math inline">\(r &gt; 1\)</span>: <span class="math inline">\(N(t)\)</span> grows without bound</li>
<li><span class="math inline">\(r &lt; 1\)</span>: <span class="math inline">\(N(t)\)</span> decays to the constant <span class="math inline">\(a/(1-r)\)</span></li>
<li><span class="math inline">\(r = 1\)</span>: <span class="math inline">\(N(t)\)</span> remains constant</li>
</ul>
<p>As we see, there are only two options for solution of linear difference equations: ever-faster growth or decay to zero or another constant value. The exponential growth of populations is also known as after the early population modeler Thomas Malthus. He used a simple population model with constant growth rate to predict demographic disaster due to the exponentially increasing population outstripping the growth in food production. In fact, human population has not been growing with a constant birth rate, and food production has (so far) kept up pace with population size, illustrating yet again that mathematical models are only as good as the assumptions that underlie them.</p>
</section>
<section id="exercises" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="exercises"><span class="header-section-number">10.2.4</span> Exercises</h3>
<p>For the following scenarios for a population: 1) Construct a dynamic model by writing down a difference equation both in the updating function form (<span class="math inline">\(N(t+1) = f(N(t))\)</span>) and the increment form (<span class="math inline">\(N(t+1) - N(t) = g(N(t))\)</span>) and specify the time step; 2) find the solution of the linear difference equation with a generic initial value and check that it satisfies the difference equation by plugging the solution into your equation (in either form); 3) plug in the given initial value and predict the future.</p>
<ol type="1">
<li><p>Zombies have appeared in Chicago. Every day, each zombie produces 3 new zombies. Suppose that initially there is only one zombie, how many zombies will there be in 7 days?</p></li>
<li><p>Suppose hunters kill 50 deer in a national forest every hunting season, while the deer by themselves have equal birth and death rates. If there are initially 500 deer in the forest, predict how many there will be in 5 years.</p></li>
<li><p>The number of infected people in a population grows by 8% per day and those who become infected remain infected. If initially there are 8 infected, how many individuals will be infected in 45 days?</p></li>
<li><p>Suppose bacteria in a population divide in 2 every hour and 90% of the current population dies after reproduction, not including the new offspring. If the population initially has 10 million bacteria, predict how many there will be in 12 hours.</p></li>
<li><p>In a rabbit population, each pair produces 2.2 offspring every year (i.e.&nbsp;1.1 per capita) and the adults have a 0.9 annual death rate after reproduction (and assume the whole population is paired up into mating pairs.) If initially there are 55 rabbits, predict how many there will be in 5 years.</p></li>
<li><p>Consider the same rabbit population, but now a python that lives nearby eats exactly 1 rabbit a month. If initially there are 55 rabbits, how many do you predict will be in 10 years?</p></li>
<li><p>10 fish are added to an aquarium every month, while 80% of those present survive every month and there is no reproduction. If initially there are 10 fish in the aquarium, predict how many there will be in 2 years.</p></li>
<li><p>A Mardi Gras parade marches down the street, and every block 50 new revelers join the parade, while 20% of parade leaves for various reasons. Suppose the parade starts with 12 people, predict how many there will be after 30 blocks.</p></li>
<li><p>Twenty flies fly into a house every day, and half of the flies in the house at beginning of each day find their way out (no births or deaths happen in the house.) If there are 10 files in the house initially, how many will there be in 12 days?</p></li>
<li><p>Every day someone eats 10 pieces of candy from a bowl, while someone else adds half as many pieces as are currently in the bowl (before 10 pieces are removed.) If there are currently 20 pieces of candy in the bowl, how many will there be in 7 days?</p></li>
</ol>
</section>
</section>
<section id="numerical-solutions-in-r" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="numerical-solutions-in-r"><span class="header-section-number">10.3</span> Numerical solutions in R</h2>
<p></p>
<section id="for-loops" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="for-loops"><span class="header-section-number">10.3.1</span> for loops</h3>
<p>Often times one has to write a script to perform the same (or similar) task many times. Like all programming languages, R has commands that call for repetition of the same commands multiple times. These structures are called . In this section you will learn about the <em>for loop</em>, which looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    body of the loop</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, the following script will print out “Hello!” ten times like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Hello!"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"
[1] "Hello!"</code></pre>
</div>
</div>
<p>The for loop starts with the keyword <code>for</code>, then has the expression in parentheses (i in 1:10). <code>i</code> is called the <em>loop variable</em>, <code>in</code> is another keyword, and <code>1:10</code> is a <em>loop vector</em>. After the first line there is a curly bracket { and everything that follows until the closing bracket } is the <em>loop body</em>. The loop body is executed as many times as there are elements in the loop vector (in this example, 10 times) and the only thing that changes is the values of the loop variable i, which starts with the first element of the vector (1) and goes until it reaches the last element (10) and then stops:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Iteration number"</span>, i))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iteration number 1"
[1] "Iteration number 2"
[1] "Iteration number 3"
[1] "Iteration number 4"
[1] "Iteration number 5"
[1] "Iteration number 6"
[1] "Iteration number 7"
[1] "Iteration number 8"
[1] "Iteration number 9"
[1] "Iteration number 10"</code></pre>
</div>
</div>
<p>It can be used to do repetitive calculations, for example, adding up all the integers in an array (of course the built-in function <code>sum()</code> will do it too):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add up the integers from 1 to 10 and print out the total</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>total<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  total<span class="ot">&lt;-</span>total<span class="sc">+</span>i</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
</section>
<section id="using-vectors-with-loops" class="level3" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="using-vectors-with-loops"><span class="header-section-number">10.3.2</span> using vectors with loops</h3>
<p>It is especially useful to use loops to assign vector variables one element at a time. The loop variable (e.g.&nbsp;<code>i</code>) is usually used for <em>indexing</em> the vector variable. There are several necessary features of using vectors in for loops, so let us take an example script and break them down in this example of calculating a vector of the sum of integers from 1 up to the current number:</p>
<ol type="1">
<li><em>Pre-allocate</em> the vector variable: create a vector of the correct length prior to the loop by filling it with a placeholder value, e.g.&nbsp;0 or NA (not a value).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>total_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, max <span class="sc">+</span> <span class="dv">1</span>)  <span class="co"># pre-allocate the vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Only put in the loop what has to be repeated (e.g.&nbsp;don’t put the pre-allocation inside the loop);</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max) { <span class="co"># iterate for i from 1 to max</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  total_vec[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> total_vec[i] <span class="sc">+</span> i <span class="co"># assign to the next value of total_vec the sum of i and the current value of total_vec</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Be careful with indexing inside for loops - this means paying careful attention to the lowest and the highest index that you’re using inside the loop. For example, if your loop vector goes from 1 to max (as above), the total number of elements in your vector will be max+1, because we assigned the element with index i+1 in the loop:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(total_vec)) <span class="co"># print the number of elements of total_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0  1  3  6 10 15 21 28 36 45 55</code></pre>
</div>
</div>
<p>Here is an example of a loop calculating the famous Fibonacci sequence, where the next value is defined to be the sum of two previous values in the sequence, and the plotting the resulting sequence, together with an exponential function that approximates it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>num_steps <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># number of steps</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fib <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, num_steps <span class="sc">+</span> <span class="dv">2</span>) <span class="co"># pre-allocate vector with correct number of elements with all 1s</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_steps) {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  fib[i<span class="sc">+</span><span class="dv">2</span>] <span class="ot">&lt;-</span> fib[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> fib[i] <span class="co"># add elements i and i+1 and assign it to element i+2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(num_steps<span class="sc">+</span><span class="dv">1</span>) <span class="co"># define a "time" vector as the independent variable</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (time, fib, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">xlab =</span> <span class="st">'time steps'</span>, <span class="at">ylab =</span> <span class="st">"Fibonacci"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># an exponential function wiht the Golden ratio base</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">sqrt</span>(<span class="dv">5</span>))<span class="sc">/</span><span class="dv">2</span> <span class="co"># golden ratio</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>sol <span class="ot">&lt;-</span> <span class="fl">0.75</span><span class="sc">*</span>phi<span class="sc">^</span>time <span class="co"># calculate the exponential function vector (no loop required)</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time, sol, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">3</span>) <span class="co"># overlay the exponential function plot</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="co"># legend placement</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Fibonacci"</span>, <span class="st">"exponential"</span>), <span class="co"># vector containing labels for the legend</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="co"># vector containing color codes (1 is black, 2 is red)</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># vector specifying line types (0 is none, 1 is regular line)</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="cn">NA</span>), <span class="co"># vector specifying types of point markers (1 is cicle, NA is none)</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lindiff_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exercises-1" class="level3" data-number="10.3.3">
<h3 data-number="10.3.3" class="anchored" data-anchor-id="exercises-1"><span class="header-section-number">10.3.3</span> Exercises:</h3>
<ol type="1">
<li><p>Assign the value 5 to a variable and multiply it by 1.03, replacing the old value of the variable. The new value should be 5.15.</p></li>
<li><p>Write a script to take a number and multiply it by 1.03 one hundred times using a for loop (see section 4.4.2) Starting with the initial value 5, the script should return the value 96.093.</p></li>
<li><p>Preallocate a vector of values to be all zeros, assign the first element to 5, and then use a for loop to calculate 100 values by multiplying the previous one by 1.03 and assigning them to sequential elements of the vector, then plot that vector. You should see an exponentially growing curve, with the last element (101st) equal to 96.093.</p></li>
<li><p>Fix the indexing error in the script below for calculating a vector of factorials. Each element of the vector <code>factorial_vec[i]</code> should be equal to <span class="math inline">\(i!= 1*2*3...*i\)</span>, so for example <code>factorial_vec[2]</code> should be 2 and <code>factorial_vec[3]</code> should be 6.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiply integers from 1 to 10 and assign the factorials to the vector </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>max.num <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>factorial_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,max.num)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max.num) {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  factorial_vec[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span>factorial_vec[i]<span class="sc">*</span>i</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(factorial_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sampling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sampling distribution and estimation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./graph_odes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>